@{
    ViewBag.Title = "Average Order Quantity Per Year";
}


<div id="averageOrderQuantityChart" style="width: 800px; height: 400px;"></div>

@section foot {
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        google.charts.load('current', { packages: ['corechart', 'line'] });
        google.charts.setOnLoadCallback(initAverageOrderQuantityChart);

        function initAverageOrderQuantityChart() {
            fetch('@Url.Action("Data9", "Chart")')
                .then(response => response.json())
                .then(data => {
                    const chartData = new google.visualization.DataTable();
                    chartData.addColumn('string', 'Year');
                    chartData.addColumn('number', 'Average Order Quantity');
                    chartData.addColumn({ type: 'string', role: 'annotation' });

                    data.forEach(item => {
                        chartData.addRow([item[0], item[1], item[1].toFixed(2)]);
                    });

                    const options = {
                        title: 'Average Order Quantity Per Year',
                        hAxis: {
                            title: 'Year',
                        },
                        vAxis: {
                            title: 'Average Order Quantity',
                        },
                        series: {
                            0: { type: 'bars', color: '#4285F4' },
                            1: { type: 'line', color: '#DB4437', lineWidth: 2, pointSize: 5 }
                        },
                        legend: { position: 'bottom' },
                    };

                    const chart = new google.visualization.ComboChart(document.getElementById('averageOrderQuantityChart'));
                    chart.draw(chartData, options);
                })
                .catch(error => console.error('Error fetching average order quantity data:', error));
        }
    </script>
}

